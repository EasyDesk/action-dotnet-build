name: .Net Build
description: Builds a .NET solution or project

branding:
  color: green
  icon: check

inputs:
  build-args:
    description: Additional build arguments to pass to 'dotnet build'.
    required: false
  build-configuration:
    description: The build configuration to use (defaults to 'Release').
    required: false
    default: Release
  path:
    description: The path to the project or solution to build (defaults to the current directory).
    required: false
    default: .
  warnings-as-errors:
    description: Whether to treat warnings as errors.
    required: false
    default: 'false'

runs:
  using: composite
  steps:
    - name: Restore Nuget packages
      shell: bash
      env:
        DOTNET_NOLOGO: 'true'
        DOTNET_CLI_TELEMETRY_OPTOUT: 'true'
        DOTNET_SKIP_FIRST_TIME_EXPERIENCE: 'true'
      run: dotnet restore '${{ inputs.path }}'
    - name: Build Solution
      env:
        DOTNET_NOLOGO: 'true'
        DOTNET_CLI_TELEMETRY_OPTOUT: 'true'
        DOTNET_SKIP_FIRST_TIME_EXPERIENCE: 'true'
      shell: bash
      run: |
        ARGS='${{ inputs.build-args }}'
        if [[ '${{ inputs.warnings-as-errors }}' == 'true' ]] ; then
          ARGS="-warnaserror $ARGS"
        fi
        dotnet build '${{ inputs.path }}' -c '${{ inputs.build-configuration }}' --no-restore $ARGS
